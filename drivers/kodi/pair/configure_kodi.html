<style type="text/css">
  span label {
    width: 100px
  }
</style>
<script type="text/javascript">       
    // Set window options
    var width	= 400;
    var height	= 400;
    var left	= (screen.width/2)-(width/2);
    var top		= (screen.height/2)-(height/2);
    var url;   
	
	function configure()
	{		
    $('.kodi-err-msg').text('')
    
		var name = $("#name").val();
		var ipAddress = $("#ip_address").val();
		var port = $("#port").val();
		var username = $("#username").val();
		var password = $("#password").val();
	
		var params = {
			name: name,
			host: ipAddress,
			httpPort: port,
			username: username,
			password: password
		}	
		
		Homey.emit( 'configure_kodi', params, function ( err, result ) {
			if(err) {
				$('.kodi-err-msg').text(err)
			}
			else {
				//Successfully connected
				Homey.addDevice({
					data: { // this data object is saved to- and unique for the device. It is passed on the get and set functions as 1st argument
						id: ipAddress // something unique, so your driver knows which physical device it is. A MAC address or Node ID, for example. This is required
					},
					name: name, // the name for this device (optional),
					settings: { 
						host: ipAddress,
						http_port: port,
						username: username,
						password: password
					} // initial settings (optional)
				}, function( err, result ){
					if( err ) return console.error(err);
				});
				
				//Done pairing
				Homey.done();
			}			
		} );	
	}    
</script>

<p id="authentication_text" data-i18n="pair.authorization.configuration_explanation"></p>
<p class="form-group">
  <span class="input-wrap">    
    <label for="name">Name:</label>      
    <input type="text" id="name"></input>
    
    <label for="ip_address">IP Address:</label>    
    <input type="text" id="ip_address"></input>
    
    <label for="port">Port:</label>          
    <input type="text" id="port"></input>
    
    <label for="username">Username:</label>          
    <input type="text" id="username"></input>
    
    <label for="password">Password:</label>          
    <input type="text" id="password"></input>
  </span>    
</p>
<button class="button" id="authentication_button" onclick="configure();" data-i18n="pair.authorization.start_configuration" />
<br /><br />
<p class="kodi-err-msg" style="color: #ff6300;"></p>